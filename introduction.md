好的，这是根据您提供的最新信息，为您的平衡小车项目定制的 **“文档简介”** 和 **“总体描述”** 部分。这部分内容更加精确，并突出了您项目的具体硬件配置和功能需求。

---

### **基于STM32F103RCT6的智能平衡小车项目软件开发文档**

**文档版本：** 1.1
**发布日期：** 2023-10-27
**项目经理：** [您的名字/团队成员名字]
**软件开发：** [团队成员名字]
**硬件开发：** [团队成员名字]
**测试工程师：** [团队成员名字]

---

### **1. 文档简介**

#### 1.1 项目概述
本项目旨在开发一款以高性能、低成本ARM Cortex-M3内核微控制器**STM32F103RCT6**为核心的**两轮自平衡小车**。小车集成**K210视觉识别模块**、**超声波测距模块**、**OLED显示屏**及**蓝牙通信模块**，构成一个功能完备的嵌入式移动机器人平台。项目目标为实现小车的**自主姿态平衡控制**，并在此基础上，融合多传感器信息，实现**远程遥控**、**视觉避障**、**超声波跟随**以及**脚本化自动动作**等高级功能，最终打造一个稳定、智能且可扩展的示范性系统。

#### 1.2 项目目标
*   **核心目标：** 基于STM32F103RCT6，实现小车在**最大负重4kg**条件下的稳定、快速自平衡，核心控制算法具备高鲁棒性。
*   **功能目标：**
    1.  通过**蓝牙模块**实现对小车的实时远程遥控（前进、后退、转向、停止）。
    2.  利用**K210视觉模块**进行前方障碍物识别，并实现自主避障行为。
    3.  利用**超声波模块**实现对小车的跟随功能。
    4.  设计并实现一套简单的**脚本解释器**，使小车能按预定义的脚本序列自动执行一系列动作。
    5.  通过**OLED显示屏**实时显示系统状态（如倾角、速度、模式、电池电压等）。
*   **技术目标：** 深入实践并掌握嵌入式实时系统设计、PID控制算法、传感器数据融合、机器视觉应用及多任务调度等关键技术。

#### 1.3 文档范围
本文档是本项目的权威技术参考，涵盖了从**软件需求规格**、**系统架构设计**、**模块详细设计**到**测试验证**的全流程。它定义了所有软件相关的功能、性能指标及接口规范，适用于所有项目开发、测试及管理人员。

#### 1.4 参考文献
*   STM32F103xx参考手册
*   MPU6050数据手册
*   Kendryte K210 官方文档
*   HC-SR04超声波模块数据手册
*   SSD1306 OLED显示屏数据手册
*   HC-05/HC-06蓝牙模块AT指令集

---

### **2. 总体描述**

#### 2.1 产品功能
本智能平衡小车系统是一个复杂的嵌入式系统，其核心功能建立在**姿态平衡控制系统**之上，并在此基础上扩展出多种智能行为模式。主要功能模块包括：

1.  **自动姿态控制系统：** 这是系统的基石。通过惯性测量单元实时采集车身姿态数据，在STM32中进行**传感器融合（如互补滤波）** 以解算出精确的俯仰角，并采用**PID控制算法**动态调整两个直流电机的输出力矩，使小车在各种扰动下维持动态平衡。

2.  **远程遥控系统：** 通过**蓝牙模块**与智能手机或电脑建立无线通信链路。用户可发送控制指令，系统解析后将其转换为小车的目标速度或转向指令，实现灵活的手动操控。

3.  **多模态感知与避障系统：**
    *   **视觉避障：** **K210视觉模块**作为“眼睛”，负责实时处理前方图像，通过训练好的模型或颜色跟踪算法识别障碍物。识别结果通过串口发送给主控STM32，主控据此规划路径，实现智能绕障。
    *   **超声波跟随：** **超声波模块**提供精确的距离信息。在此模式下，小车会自动与前方目标（如人）保持一个设定的安全距离，实现自动跟随功能。

4.  **脚本化任务系统：** 系统具备接收并解析简单脚本（如通过蓝牙发送）的能力。脚本可以包含一系列动作指令（如“前进2秒”、“左转90度”、“等待”等），使小车能够自主完成复杂的预设任务序列。

5.  **人机交互系统：** **OLED显示屏**作为主要的信息输出界面，实时刷新显示系统的关键运行参数，如当前工作模式、车身倾角、电机PWM值、电池电量等，极大方便了系统的调试与状态监控。

#### 2.2 用户特征
*   **最终用户：** 对智能机器人感兴趣的爱好者或演示人员，具备基本的移动设备操作能力。
*   **开发与维护人员：** 熟悉C/C++语言、STM32开发、嵌入式系统设计及控制理论的工程师或学生。

#### 2.3 设计与实现约束
*   **硬件平台：**
    *   主控MCU：**STM32F103RCT6**。
    *   关键传感器：MPU6050（IMU）、HC-SR04（超声波）、K210（视觉）。
    *   人机接口：0.96寸OLED显示屏（I2C）、蓝牙模块（UART）。
    *   动力系统：带编码器的直流减速电机、TB6612FNG或L298N电机驱动。
    *   电源：锂电池组，需考虑电源管理，为整个系统提供稳定供电。
*   **软件平台：**
    *   语言：嵌入式C。
    *   库：标准外设库或HAL库。
    *   操作系统：考虑使用FreeRTOS以实现多任务并发管理。
*   **性能与物理约束：**
    *   系统需在**最大负载4kg**的条件下稳定运行。
    *   平衡控制环路频率不低于500Hz，以确保控制的实时性和稳定性。
    *   各功能模块间的通信需可靠，协议简洁。

---

